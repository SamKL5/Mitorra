1) База данных должна состоять минимум из почты, пароля, кода подтверждения(4 символа).
При успешном сравнивании введеного пароля и пароля из базы, создается рандомное четырехзначное число с помощью функции rand(min, max).
Затем оно добавляется в базу данных в строку пользователя.
На почту пользователя отправляется сгенерированный код с помощью функции mail($to, $subject, $message). В $to почта пользователя, в $subject тему сообщения,
в $message сообщение с кодом.
На страницы авторизации в поле вводится код из почты и при нажатии проверяется код из базы данных.
Затем код удаляется из бд.
2) Так же можно использовать программу Google Authenticator, подключая библиотеку.
